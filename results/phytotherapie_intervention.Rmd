---
title: 'Data analysis: Intervention Phytotherapie'
output:
  pdf_document: default
  html_notebook: default
---

## Experiment by ENVIRE partner: Tunisia

$315$ broilers are divided into $9$ groups with different control/interventions:
G1. negative control 
G2. treated with antibiotics
G3. positive control 
G4. fed with 5g/kg thyme
G5. fed with 5g/kg rosemary
G6. treated with 0.3ml/L thyme
G7. treated with 0.3ml/L rosemary
G8. fed with 5g/kg thyme and treated with 0.3ml/L thyme
G9. fed with 5g/kg rosemary and treated with 0.3ml/L rosemary

After inoculing E. coli R56 on the third day, cloacal swab measurements were 
taken on $5$, $17$, $25$ and $34$-th day.

```{r}
g1 <- c(3, 1, 3, 0)
g2 <- c(3, 34, 30, 20)
g3 <- c(8, 30, 5, 7)
g4 <- c(10, 31, 16, 10)
g5 <- c(8, 10, 6, 3)
g6 <- c(6, 7, 4, 3)
g7 <- c(12, 4, 4, 2)
g8 <- c(23, 17, 15, 4)
g9 <- c(25, 8, 9, 3)


# Load necessary libraries
library(ggplot2)

# Given days
days <- c(5, 17, 25, 34)

# Number of broilers
total_broilers <- 35

# Convert to prevalence
prevalence <- function(group) {
  return(group / total_broilers)
}

# Calculate prevalence for each group
prevalence_g1 <- prevalence(g1)
prevalence_g2 <- prevalence(g2)
prevalence_g3 <- prevalence(g3)
prevalence_g4 <- prevalence(g4)
prevalence_g5 <- prevalence(g5)
prevalence_g6 <- prevalence(g6)
prevalence_g7 <- prevalence(g7)
prevalence_g8 <- prevalence(g8)
prevalence_g9 <- prevalence(g9)

# Create a data frame for plotting
data <- data.frame(
  days = rep(days, 9),
  prevalence = c(prevalence_g1, prevalence_g2, prevalence_g3, prevalence_g4, prevalence_g5, prevalence_g6, prevalence_g7, prevalence_g8, prevalence_g9),
  group = factor(rep(c("Negative Control", "Antibiotics", "Positive Control", "5g/kg Thyme", "5g/kg Rosemary", "0.3ml/L Thyme", "0.3ml/L Rosemary", "5g/kg Thyme + 0.3ml/L Thyme", "5g/kg Rosemary + 0.3ml/L Rosemary"), each = 4))
)

# Plot the prevalence dynamics
ggplot(data, aes(x = days, y = prevalence, color = group, group = group)) +
  geom_line() +
  geom_point() +
  labs(title = "Prevalence Dynamics of E. coli R56 in Broilers",
       x = "Day",
       y = "Prevalence",
       color = "Group") +
  theme_minimal() +
  theme(legend.title = element_blank())

```

